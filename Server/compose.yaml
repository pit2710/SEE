version: "3.8"

networks:
  server-network:
    driver: bridge
    ipam:
      config:
        - subnet: 172.18.0.0/16

services:
  frontend-server:
    build: ./Frontend
    container_name: frontend
    depends_on:
      - backend-server
    networks:
      server-network:
        ipv4_address: 172.18.0.6
    ports:
      - "80:8080"

  backend-server:
    privileged: true
    build: ./Backend
    container_name: backend
    restart: always
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    depends_on:
      - storage-server
    networks:
      server-network:
        ipv4_address: 172.18.0.2
    ports:
      - "8080:8080"
    environment:
      SQLITE_DB_FILE: /see/database.db
      MINIO_URL: 172.18.0.4  # IP-Adresse des Minio-Servers
      MINIO_PORT: 9000
      MINIO_DEFAULT_BUCKETS: test
      MINIO_ROOT_PASSWORD: your_password
      MINIO_ROOT_USER: your_username
      FRONTEND_URL: http://localhost
      JWT_SECRET: 1RNG9ja6MtadMuLsRC5ci3fy53KcQJmdEWWrp3hV5dnukvW5SQ

  storage-server:
    image: docker.io/bitnami/minio:latest
    container_name: storage
    networks:
      server-network:
        ipv4_address: 172.18.0.4
    environment:
      MINIO_ROOT_USER: your_username
      MINIO_ROOT_PASSWORD: your_password
      MINIO_DEFAULT_BUCKETS: test
